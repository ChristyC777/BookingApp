# Εφαρμογή Booking #

## Λειτουργίες manager: ##

-	Πρόσθεση καταλυμάτων.

-	Πρόσθεση διαθέσιμων ημερομηνιών προς ενοικίαση για τα καταλύματα.

-	Εμφάνιση κρατήσεων για καταλύματα σε που έχουν σε ιδιοκτησία τους.

-	Διαχείριση μέσω console application.

-	Εμφάνιση συνολικών κρατήσεων ανά περιοχή για συγκεκριμένο χρονικό διάστημα.

## Λειτουργίες ενοικιαστή: ##

-	Φιλτράρισμα (location, date, numberOfPeople, price, stars).

-	Κράτηση.

-	Βαθμολόγηση με αστέρια (1 – 5).

-	Μέσω UI σε Android έχουμε ενέργειες:
    - **search():** στέλνει φίλτρο στον Master ασύγχρονα και εμφανίζει τα αποτελέσματα.
    - **book():** Κράτηση για ένα κατάλυμα από εκείνα που επέστρεψε η search()

_**Σημείωση:** Προκειμένου το σύστημα να μπορεί να διαχειριστεί τον όγκο των δεδομένων θα πρέπει να μπορεί να τρέξει κατανεμημένα πάνω από ένα σύνολο μηχανημάτων._

## Εργαλεία: ##

-	**MapReduce framework:** προγραμματιστικό μοντέλο που επιτρέπει την παράλληλη επεξεργασία μεγάλων όγκων δεδομένων (διαχείριση μεγάλου όγκου δεδομένων), βασίζεται στην χρήση των συναρτήσεων ‘Map’ και ‘Reduce’.
    - **Map(key, value):** Είσοδος: γραμμές αρχείου κτλ. (key, value).
      
      Μετατρέπει (key, value) -> (key2, value2).
    
      Εκτέλεση παράλληλα σε διαφορετικούς κόμβους με διαφορετικές εισόδους.
    
      _**Σημείωση:** Ο βαθμός παραλληλίας εξαρτάται από την εφαρμογή και ορίζεται από τον χρήστη._
    
    - **Reduce(key2, value2):** Συγχώνευση ενδιάμεσων values που σχετίζονται με το ίδιο κλειδί και παράγει τα τελικά αποτελέσματα. Για κάθε key -> list(values). 
    
      _**Σημείωση:** Η επεξεργασία της συνάρτησης reduce γίνεται αφού έχει τελειώσει η επεξεργασία όλων των map συναρτήσεων._

-	**json:** Για προσθήκη καταλύματος, ακολουθεί το παρακάτω πρότυπο:

    {
      "roomName": "roomName",
      "noOfPersons": 5,
      "area": "Area1",
      "stars": 3,
      "noOfReviews": 15,
      "roomImage": "/usr/bin/images/roomName.png"
    }

-	**Workers:** Nodes.

-	**Hashing:** Χρησιμοποιείται το όνομα δωματίου σαν input για το hashing.

## Διαδικασίες: ##
-	Αρχική επικοινωνία του console app του manager γίνεται με τον Master, αποστέλλονται όλα τα στοιχεία του καταλύματος μέσω αυτής.
Αφού ο Master λάβει τα στοιχεία, μέσω μιας hash συνάρτησης H(roomName) επιλέγει τον worker στον οποίο θα αποθηκευτεί το κατάλυμα. 

    π.χ. nodeID = H(roomName) mod NumberOfNodes

-	Αφού επιλέξει τον κόμβο αποστέλλει τις πληροφορίες σε αυτόν.

_**Παρατήρηση:** O worker αποθηκεύει τις πληροφορίες στις κατάλληλες δομές δεδομένων στην μνήμη του. ΔΕΝ επιτρέπεται αποθήκευση στον δίσκο, εκτός από τις φωτογραφίες αν το επιθυμούμε._

-	Όταν ένας χρήστης επιθυμεί να νοικιάσει ένα κατάλυμα αρχικά μέσω της εφαρμογής θα πρέπει να επιλέξει τα κατάλληλα φίλτρα για το κατάλυμα που επιθυμεί.
  Τότε αποστέλλεται ένα request προς τον master που περιέχει τα φίλτρα. O Master θα πρέπει με διαδικασία MapReduce να επιστρέφει τα καταλύματα που ικανοποιούν τα κριτήρια.

-	Αφού προβληθούν στον χρήστη, εκείνος θα μπορεί να δει αναλυτικά τα στοιχεία και τη φωτογραφία του δωματίου και να προβεί σε κράτηση εφόσον επιθυμεί.

-	Όταν ο χρήστης πραγματοποιήσει κράτηση, στέλνει ένα request κράτησης στον Master για το συγκεκριμένο κατάλυμα και ο Master με τη σειρά του πρέπει να ενημερώσει κατάλληλα τον Worker που διαχειρίζεται το κατάλυμα για την κράτηση.

_**Προσοχή:** Θα πρέπει να ληφθούν μέτρα ώστε να μην μπορεί να συμβεί ταυτόχρονη κράτηση στο ίδιο κατάλυμα για τις ίδιες ημερομηνίες._

## Backend: ##

-	Master σε γλώσσα Java και αποτελεί τον TCP server. **ΔΕΝ** επιτρέπεται χρήση έτοιμων libraries εκτός από default ServerSocket της Java ή HTTP πρωτοκόλλου με τη χρήση έτοιμου server.

-	O Master θα είναι πολυνηματικός, εξυπηρετεί πολλούς ταυτόχρονα και επικοινωνεί με τους workers.

-	Οι Workers πρέπει να είναι σε Java και να είναι πολυνηματικοί για να εκτελούν πολλά requests από τον Master.

-	Οι Workers ορίζονται δυναμικά κατά το initialization του Master. Ο αριθμός τους είναι αυθαίρετος και ορίζεται είτε σε arguments είτε σε config αρχείο.

-	Master – Worker: Επικοινωνούν με TCP sockets.

-	Συγχρονισμός όπου απαραίτητο (synchronized, wait – notify), **ΟΧΙ** με τη χρήση έτοιμων εργαλείων της βιβλιοθήκης java.util.concurrent ή άλλων έτοιμων εργαλείων.

-	Οι δομές δεδομένων πρέπει να είναι αποθηκευμένες στην μνήμη. 

_**ΠΡΟΣΟΧΗ: Απαγορεύεται η χρήση βάσης δεδομένων.**_

## Frontend: ##
-	Application – Master: TCP sockets

-	Χρήση Threads.

## Παραδοτέα εργασίας: ##
Το project θα παραδοθεί σε δύο φάσεις:

### Παραδοτέο Α: (Ημερομηνία παράδοσης: 7/04/2024) ###
Στο παραδοτέο αυτό, θα πρέπει να έχετε ολοκληρώσει εντελώς το backend σύστημα και το manager console app, όπως ακριβώς σας έχει ζητηθεί, έτσι ώστε να μπορεί να
χρησιμοποιηθεί στην επόμενη φάση της εργασίας του μαθήματος (προσθήκη δωματίου και διαθέσιμων ημερομηνιών για κρατήσεις, εμφάνιση κρατήσεων).
Αντί για android application θα έχετε μια dummy εφαρμογή όπου θα στέλνει το τα φίλτρα για τα δωμάτια στον Master και θα λαμβάνει τα αντίστοιχα αποτελέσματα.
Επίσης θα πρέπει ο χρήστης να μπορεί να κάνει κράτηση από την dummy εφαρμογή.

### Παραδοτέο Β: (Ημερομηνία παράδοσης: 26/05/2024) ###
Το παραδοτέο αυτό αποτελεί το Αndroid application, που περιγράφηκε παραπάνω. Στη φάση αυτή το σύστημα θα πρέπει να είναι πλήρως λειτουργικό και ολοκληρωμένο, με όλα τα components του να λειτουργούν σωστά.
Σε αυτή τη φάση το manager console app θα πρέπει να μπορεί να εκτελέσει και το aggregation query για τις συνολικές κρατήσεις ανά περιοχή για ένα συγκεκριμένο χρονικό διάστημα.

**Bonus (20%):** Active replication

### Σχεδιάγραμμα Σχέσεων

![Διάγραμμα Σχέσεων](/images/scheme.png)

### Domain Model

![Domain Model](/images/new.png)